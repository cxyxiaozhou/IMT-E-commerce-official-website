"use strict";(self["webpackChunkhm_shopping"]=self["webpackChunkhm_shopping"]||[]).push([[832],{7832:function(e,t,i){i.r(t),i.d(t,{default:function(){return h}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"login"},[t("van-nav-bar",{attrs:{title:"VipLogin","left-arrow":""},on:{"click-left":function(t){return e.$router.go(-1)}}}),t("div",{staticClass:"container"},[e._m(0),t("div",{staticClass:"form"},[t("div",{staticClass:"form-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.mobile,expression:"mobile"}],staticClass:"inp",attrs:{maxlength:"11",placeholder:"please input number",type:"text"},domProps:{value:e.mobile},on:{input:function(t){t.target.composing||(e.mobile=t.target.value)}}})]),t("div",{staticClass:"form-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.picCode,expression:"picCode"}],staticClass:"inp",attrs:{maxlength:"5",placeholder:"please input Verification Code",type:"text"},domProps:{value:e.picCode},on:{input:function(t){t.target.composing||(e.picCode=t.target.value)}}}),e.picUrl?t("img",{attrs:{src:e.picUrl,alt:""},on:{click:e.getPicCode}}):e._e()]),t("div",{staticClass:"form-item"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.msgCode,expression:"msgCode"}],staticClass:"inp",attrs:{placeholder:"please SMS verification code ",type:"text"},domProps:{value:e.msgCode},on:{input:function(t){t.target.composing||(e.msgCode=t.target.value)}}}),t("button",{on:{click:e.getCode}},[e._v(e._s(e.second===e.totalSecond?"gets informations":e.second+"seconds is reloading"))])])]),t("div",{staticClass:"login-btn",on:{click:e.login}},[e._v("Login")])])],1)},o=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"title"},[t("h3",[e._v("Iphone Login")]),t("p",[e._v("Unregisted is auto login")])])}],a=i(1981),n=i(5720);const c=()=>n.A.get("/captcha/image"),r=(e,t,i)=>n.A.post("/captcha/sendSmsCaptcha",{form:{captchaCode:e,captchaKey:t,mobile:i}}),l=(e,t)=>n.A.post("/passport/login",{form:{isParty:!1,partyData:{},mobile:e,smsCode:t}});var d={name:"LoginPage",data(){return{picCode:"",picKey:"",picUrl:"",totalSecond:3,second:3,timer:null,mobile:"",msgCode:""}},async created(){this.getPicCode()},methods:{async getPicCode(){const{data:{base64:e,key:t}}=await c();this.picUrl=e,this.picKey=t},async login(){if(!this.validFn())return;if(!/^\d{6}$/.test(this.msgCode))return void(0,a.A)("please correct Verification Code");const e=await l(this.mobile,this.msgCode);console.log(e),this.$store.commit("user/setUserInfo",e.data),(0,a.A)("Login successful");const t=this.$route.query.backUrl||"/";this.$router.replace(t)},validFn(){return/^1[3-9]\d{9}$/.test(this.mobile)?!!/^\w{4}$/.test(this.picCode)||((0,a.A)("please correct graphical"),!1):((0,a.A)("please correct number"),!1)},async getCode(){this.validFn()&&(this.timer||this.second!==this.totalSecond||(await r(this.picCode,this.picKey,this.mobile),(0,a.A)("SMS Successful"),this.timer=setInterval((()=>{this.second--,this.second<=0&&(clearInterval(this.timer),this.timer=null,this.second=this.totalSecond)}),1e3),(0,a.A)("get successful!")))},onClickLeft(){(0,a.A)("返回")},onClickRight(){(0,a.A)("按钮")}},destroyed(){clearInterval(this.timer)}},p=d,m=i(1656),u=(0,m.A)(p,s,o,!1,null,"71b83700",null),h=u.exports}}]);
//# sourceMappingURL=832.f02c8e31.js.map